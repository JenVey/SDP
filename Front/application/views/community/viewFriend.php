<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>gather.owl - Friends</title>
    <link rel="icon" href="<?php echo base_url(); ?>asset/Images/android-chrome-512x512.png">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/bootstrap.css">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/Ours.css">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/shopCSS.css">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/channelCSS.css">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/friendCSS.css">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/animation.css">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/alertify.css">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/alerts.css">
    <link rel="stylesheet" href="<?php echo base_url(); ?>asset/CSS/themes/default.css">
    <script src="<?php echo base_url(); ?>asset/Js/alertify.js"></script>
    <script src="<?php echo base_url(); ?>asset/Js/jquery-min.js"></script>
    <script src="<?php echo base_url(); ?>asset/Js/bootstrap.js"></script>
    <script src="<?php echo base_url(); ?>asset/Js/textFit.js"></script>
    <style>
        #action1:hover #Path_1943 {
            fill: #d7c13f;
        }

        #action2:hover #Icon_awesome-exchange-alt {
            fill: #d7c13f;
        }

        #action3:hover #Icon_material-report {
            fill: #d7c13f;
        }

        #action1:hover #Path_1944 {
            fill: #d7c13f;
        }

        .channelAction {
            justify-content: space-around;
        }
    </style>

</head>
<?php
date_default_timezone_set('Asia/Jakarta');
?>

<body>
    <div class="accList">
        <div class="navbarCom">
            <button class="butNav btnFriend active" style=" border-top-left-radius: 15px; border-bottom-left-radius: 15px;">
                <svg style="margin-top: 2vh;" xmlns="http://www.w3.org/2000/svg" width="35" height="41" viewBox="0 0 35 41">
                    <path id="solid_child" data-name="solid child" d="M10.938,5.766C10.938,2.581,13.876,0,17.5,0s6.562,2.581,6.562,5.766-2.938,5.766-6.562,5.766S10.938,8.95,10.938,5.766Zm23.208.11a3.209,3.209,0,0,0-4.125,0l-7.9,6.937h-9.25l-7.9-6.937a3.209,3.209,0,0,0-4.125,0,2.349,2.349,0,0,0,0,3.624l8.625,7.577V38.438A2.757,2.757,0,0,0,12.4,41h1.458a2.757,2.757,0,0,0,2.917-2.562V29.469h1.458v8.969A2.757,2.757,0,0,0,21.146,41H22.6a2.757,2.757,0,0,0,2.917-2.562V17.077L34.146,9.5A2.349,2.349,0,0,0,34.146,5.876Z" transform="translate(0)" fill="#d7c13f" />
                </svg>
                <h6 class="varela" style="color: #ecf0f1;margin-top: 4vh;">Friends</h6>
            </button>
            <button class="butNav btnTeams">
                <svg style="margin-top: 2vh;" xmlns="http://www.w3.org/2000/svg" width="42.2" height="31.5" viewBox="0 0 42.2 31.5">
                    <path id="Icon_material-group" data-name="Icon material-group" d="M30.273,21c3.184,0,5.735-3.015,5.735-6.75S33.457,7.5,30.273,7.5s-5.755,3.015-5.755,6.75S27.089,21,30.273,21ZM14.927,21c3.184,0,5.735-3.015,5.735-6.75S18.111,7.5,14.927,7.5s-5.755,3.015-5.755,6.75S11.743,21,14.927,21Zm0,4.5C10.458,25.5,1.5,28.132,1.5,33.375V39H28.355V33.375C28.355,28.133,19.4,25.5,14.927,25.5Zm15.345,0c-.556,0-1.189.045-1.861.113a9.93,9.93,0,0,1,3.779,7.763V39H43.7V33.375C43.7,28.133,34.742,25.5,30.273,25.5Z" transform="translate(-1.5 -7.5)" fill="#d7c13f" />
                </svg>
                <h6 class="varela" style="color: #ecf0f1;margin-top: 5vh;">Teams</h6>
            </button>
            <button class="butNav btnChannel" style="border-top-right-radius: 15px; border-bottom-right-radius: 15px;">
                <svg style="margin-top: 2vh;" xmlns="http://www.w3.org/2000/svg" width="48.299" height="45.162" viewBox="0 0 48.299 45.162">
                    <g id="channel" transform="translate(0 -1.86)">
                        <g id="Group_137" data-name="Group 137" transform="translate(0 1.86)">
                            <path id="Path_1398" data-name="Path 1398" d="M128.573,13.933a6.238,6.238,0,0,0-3.544-5.545,3.836,3.836,0,0,0,.979-2.548,4.212,4.212,0,0,0-8.412,0,3.841,3.841,0,0,0,1.037,2.612,6.228,6.228,0,0,0-3.419,5.482v3.338h13.358ZM121.8,4.012a1.884,1.884,0,0,1,1.931,1.827,1.934,1.934,0,0,1-3.863,0A1.884,1.884,0,0,1,121.8,4.012Zm4.5,11.107H117.49V13.933a4.242,4.242,0,0,1,4.349-4.115h.111a4.242,4.242,0,0,1,4.349,4.115v1.186Z" transform="translate(-97.745 -1.86)" fill="#d7c13f" />
                            <path id="Path_1399" data-name="Path 1399" d="M9.814,215.768a3.836,3.836,0,0,0,.979-2.548,4.1,4.1,0,0,0-4.206-3.979,4.1,4.1,0,0,0-4.206,3.979,3.841,3.841,0,0,0,1.037,2.612A6.227,6.227,0,0,0,0,221.313v3.338H13.358v-3.338A6.238,6.238,0,0,0,9.814,215.768Zm-3.227-4.376a1.83,1.83,0,1,1,0,3.654,1.83,1.83,0,1,1,0-3.654Zm4.5,11.107H2.275v-1.186A4.241,4.241,0,0,1,6.624,217.2h.111a4.242,4.242,0,0,1,4.349,4.115S11.083,222.5,11.083,222.5Z" transform="translate(0 -179.489)" fill="#d7c13f" />
                            <path id="Path_1400" data-name="Path 1400" d="M240.244,215.768a3.836,3.836,0,0,0,.979-2.548,4.212,4.212,0,0,0-8.412,0,3.841,3.841,0,0,0,1.037,2.612,6.228,6.228,0,0,0-3.419,5.482v3.338h13.358v-3.338A6.239,6.239,0,0,0,240.244,215.768Zm-3.227-4.376a1.83,1.83,0,1,1-1.931,1.827A1.883,1.883,0,0,1,237.017,211.392Zm4.5,11.107H232.7v-1.186a4.241,4.241,0,0,1,4.349-4.115h.111a4.242,4.242,0,0,1,4.349,4.115V222.5Z" transform="translate(-195.489 -179.489)" fill="#d7c13f" />
                            <path id="Path_1401" data-name="Path 1401" d="M109.639,134.949h-2.275v7.086l-7.935,7.508,1.608,1.522L108.5,144l7.464,7.062,1.609-1.522-7.936-7.508Z" transform="translate(-84.352 -115.856)" fill="#d7c13f" />
                        </g>
                    </g>
                </svg>
                <h6 class="varela" style="color: #ecf0f1;margin-top: 3.5vh;">Channels</h6>
            </button>
        </div>
        <div class="titleAccList">
            <div class="hl"></div>
            <h4 style="color: #ecf0f1;">Friends</h4>
            <div class="hl"></div>
        </div>
        <div class="actionButs">
            <button class="action" style="width: 90%;" id="add">
                <svg xmlns="http://www.w3.org/2000/svg" width="18.07" height="18.07" viewBox="0 0 18.07 18.07">
                    <path id="Icon_ionic-ios-add" data-name="Icon ionic-ios-add" d="M25.91,16.875H19.125V10.09a1.125,1.125,0,0,0-2.25,0v6.785H10.09a1.125,1.125,0,0,0,0,2.25h6.785V25.91a1.125,1.125,0,0,0,2.25,0V19.125H25.91a1.125,1.125,0,0,0,0-2.25Z" transform="translate(-8.965 -8.965)" fill="#d7c13f" />
                </svg>
                <h6 class="varela">Add Friend</h6>
            </button>
        </div>
        <div class="actionButs">
            <div class="searchBar">
                <button class="search">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 27 27.007">
                        <path id="Icon_ionic-ios-search" data-name="Icon ionic-ios-search" d="M31.184,29.545l-7.509-7.58a10.7,10.7,0,1,0-1.624,1.645l7.46,7.53a1.156,1.156,0,0,0,1.631.042A1.163,1.163,0,0,0,31.184,29.545ZM15.265,23.7a8.45,8.45,0,1,1,5.977-2.475A8.4,8.4,0,0,1,15.265,23.7Z" transform="translate(-4.5 -4.493)" fill="#d7c13f" />
                    </svg>
                </button>
                <input type="text" placeholder="Search your Team" name="searchBar" class="searchBarInput">
            </div>
        </div>
        <div class="accItemContainer friendList">
            <?php foreach ($friend as $frn) {
                if ($frn['status'] != -1) {
                    $cekNotif = false;
                    foreach ($pesan as $psn) {
                        if ($psn['id_pengirim'] == $frn['id_user'] && $psn['id_penerima'] == $user['id_user'] && $psn['status'] == 0) {
                            $cekNotif = true;
                        }
                    } ?>
                    <?php if ($cekNotif == false) {  ?>
                        <div class="accItem listChannel" idFriend="<?= $frn['id_user'] ?>" <?php if (isset($friendA)) {
                                                                                                if ($frn['id_user'] == $friendA['id_user']) {
                                                                                                    echo "id='active'";
                                                                                                }
                                                                                            } ?>>
                            <div class="profileImg" style="margin-left: 0;"><img src="data:image/jpeg;base64,<?= base64_encode($frn['foto']) ?>" width="50" height="50" alt="" /></div>
                            <h6 class="profileName"><?= $frn['nama_user'] ?></h6>
                        </div>
                    <?php } else { ?>
                        <div class="accItem listChannel" idFriend="<?= $frn['id_user'] ?>" <?php if (isset($friendA)) {
                                                                                                if ($frn['id_user'] == $friendA['id_user']) {
                                                                                                    echo "id='active'";
                                                                                                }
                                                                                            } ?>>
                            <div class="profileImg" style="margin-left: 0;"><img src="data:image/jpeg;base64,<?= base64_encode($frn['foto']) ?>" width="50" height="50" alt="" /></div>
                            <h6 class="profileName"><?= $frn['nama_user'] . " (ADA PESAN BARU)" ?></h6>
                        </div>
                    <?php } ?>
            <?php
                }
            }
            ?>
        </div>
        <div class="titleAccList">
            <div class="hl"></div>
            <h4 style="color: #ecf0f1;">Blocked List</h4>
            <div class="hl"></div>
        </div>
        <div class="accItemContainer blockList">
            <?php foreach ($friend as $frn) {
                if ($frn['status'] == -1) { ?>
                    <div class="accItem listBlock" idFriend="<?= $frn['id_user'] ?>" <?php if (isset($friendA)) {
                                                                                            if ($frn['id_user'] == $friendA['id_user']) {
                                                                                                echo "id='active'";
                                                                                            }
                                                                                        } ?>>
                        <div class="profileImg" style="margin-left: 0;"><img src="data:image/jpeg;base64,<?= base64_encode($frn['foto']) ?>" width="50" height="50" alt="" /></div>
                        <h6 class="profileName"><?= $frn['nama_user'] ?></h6>
                    </div>
            <?php }
            }
            ?>
        </div>
    </div>
    <div class="profile">
        <div class="wrapProfile">
            <div class="profileImg"><img src="data:image/jpeg;base64,<?= base64_encode($user['foto']) ?>" width="50" height="50" alt="" /></div>
            <div class="profileStats">
                <!-- Max Line 10 -->
                <h5 class="profileName" style="font-size: 15px;margin-top: 0.5vh;"><?= $user['nama_user'] ?></h5>
                <h6 class="profileBalance">GP <?= number_format(ceil($user['saldo']), 0, ".", ".") ?>></h6>
            </div>
        </div>
        <button class="Home">
            <img style="margin-top: -3vh;" src="<?= base_url(); ?>asset/Images/android-chrome-512x512.png" width="30" height="30"></img>
            <p class="HomeText" style="margin-top: -2vh;">Main Menu</p>
        </button>
    </div>
    <div class="bodyContainer">
        <?php if (!isset($_SESSION['idFriend'])) { ?>
            <div id="banner">
                <object data="<?= base_url(); ?>/asset/Images/SVG/undraw_having_fun_iais.svg" type="image/svg+xml"></object>
                <svg style="margin-top: 5vh;" xmlns="http://www.w3.org/2000/svg" width="606" height="105" viewBox="0 0 606 105">
                    <text id="Give_all_of_em_a_toast" data-name="Give all of &apos;em a toast" transform="translate(0 74)" fill="#fff" font-size="94" font-family="Cookie-Regular, Cookie">
                        <tspan x="0" y="0">Give all of &apos;em a toast</tspan>
                    </text>
                </svg>
            </div>
        <?php } else { ?>
            <div class="chatHeader">
                <div class="chatLogo"><img src="data:image/jpeg;base64,<?= base64_encode($friendA['foto']) ?>" /></div>
                <div class="channelHeader">
                    <p style="color: rgba(216,216,216,0.61);"><?= $friendA['username_user'] ?></p>
                    <h4 class="yellow"><?= $friendA['nama_user'] ?></h4>
                </div>
                <div class="channelAction">
                    <?php foreach ($friend as $frn) {
                        if ($frn['id_user2'] == $friendA['id_user']) {
                            if ($frn['status'] == 0) { ?>
                                <button id="action1">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="56.503" height="50.474" viewBox="0 0 33.75 27">
                                        <g id="Icon_ionic-md-person-add" data-name="Icon ionic-md-person-add" transform="translate(-1.125 -4.5)">
                                            <path id="Path_1943" data-name="Path 1943" d="M21.375,18a6.75,6.75,0,1,0-6.75-6.75A6.77,6.77,0,0,0,21.375,18Zm0,3.375c-4.472,0-13.5,2.278-13.5,6.75V31.5h27V28.125C34.875,23.653,25.847,21.375,21.375,21.375Z" fill="#fff" />
                                            <path id="Path_1944" data-name="Path 1944" d="M7.875,15.75v-4.5H5.625v4.5h-4.5V18h4.5v4.5h2.25V18h4.5V15.75Z" fill="#fff" />
                                        </g>
                                    </svg>
                                </button>
                                <button id="action3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="56.503" height="50.474" viewBox="0 0 27 27">
                                        <path id="Icon_material-report" data-name="Icon material-report" d="M23.595,4.5H12.4L4.5,12.4v11.19L12.4,31.5h11.19L31.5,23.595V12.4ZM18,25.95A1.95,1.95,0,1,1,19.95,24,1.946,1.946,0,0,1,18,25.95Zm1.5-6.45h-3v-9h3Z" transform="translate(-4.5 -4.5)" fill="#fff" />
                                    </svg>
                                </button>
                            <?php } else if ($frn['status'] == 1) { ?>
                                <button id="action3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="56.503" height="50.474" viewBox="0 0 27 27">
                                        <path id="Icon_material-report" data-name="Icon material-report" d="M23.595,4.5H12.4L4.5,12.4v11.19L12.4,31.5h11.19L31.5,23.595V12.4ZM18,25.95A1.95,1.95,0,1,1,19.95,24,1.946,1.946,0,0,1,18,25.95Zm1.5-6.45h-3v-9h3Z" transform="translate(-4.5 -4.5)" fill="#fff" />
                                    </svg>
                                </button>
                            <?php } else if ($frn['status'] == 2) { ?>
                                <button id="action2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="56.503" height="50.474" viewBox="0 0 77.304 59.142">
                                        <path id="Icon_awesome-exchange-alt" data-name="Icon awesome-exchange-alt" d="M0,20.5V18.132a3.586,3.586,0,0,1,3.624-3.548H57.978v-7.1a3.637,3.637,0,0,1,6.186-2.509L76.242,16.806a3.5,3.5,0,0,1,0,5.018L64.164,33.65a3.636,3.636,0,0,1-6.186-2.509v-7.1H3.624A3.586,3.586,0,0,1,0,20.5ZM73.68,42.969H19.326v-7.1a3.637,3.637,0,0,0-6.186-2.509L1.061,45.191a3.5,3.5,0,0,0,0,5.018L13.14,62.035a3.636,3.636,0,0,0,6.186-2.509v-7.1H73.68A3.586,3.586,0,0,0,77.3,48.882V46.517A3.586,3.586,0,0,0,73.68,42.969Z" transform="translate(0 -3.936)" fill="#fff" />
                                    </svg>
                                </button>
                                <button id="action3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="56.503" height="50.474" viewBox="0 0 27 27">
                                        <path id="Icon_material-report" data-name="Icon material-report" d="M23.595,4.5H12.4L4.5,12.4v11.19L12.4,31.5h11.19L31.5,23.595V12.4ZM18,25.95A1.95,1.95,0,1,1,19.95,24,1.946,1.946,0,0,1,18,25.95Zm1.5-6.45h-3v-9h3Z" transform="translate(-4.5 -4.5)" fill="#fff" />
                                    </svg>
                                </button>
                            <?php } ?>

                    <?php }
                    } ?>
                </div>
            </div>
            <div class="chatSection">
                <div class="chatWrapper">
                    <div class="chatField">
                        <?php $cekTgl = "";
                        foreach ($pesan as $psn) {
                            if ($psn['id_penerima'] == $friendA['id_user'] || $psn['id_pengirim'] == $friendA['id_user']) {
                                $tgl = date('d F Y', strtotime($psn['tgl']));
                                if ($tgl != $cekTgl) {
                                    $cekTgl = $tgl; ?>
                                    <div class="dateChat">
                                        <div style="width: 5vw; height: 1px; background-color: #ecf0f1;"></div>
                                        <h6 style="color: #ecf0f1;"><?= date_format(date_create($psn['tgl']), "d F Y");  ?></h6>
                                        <div style="width: 5vw; height: 1px; background-color: #ecf0f1;"></div>
                                    </div>
                                <?php }
                                if ($psn['pengirim'] != $user['nama_user']) { ?>
                                    <div class="othersText">
                                        <div class="senderImg"><img src="data:image/jpeg;base64,<?= base64_encode($psn['foto']) ?>" /></div>
                                        <div class="nameText">
                                            <h6 class="senderName"><?= $psn['pengirim'] ?></h6>
                                            <div class="text">
                                                <p><?= $psn['pesan'] ?></p>
                                                <p class="textDate"><?= date('H:i', strtotime($psn['tgl'])) ?></p>
                                            </div>
                                        </div>
                                    </div>
                                <?php } else { ?>
                                    <div class="myText">
                                        <div class="my nameText">
                                            <div class="text mine">
                                                <h6 class="mySenderName"><?= $psn['pengirim'] ?></h6>
                                                <p><?= $psn['pesan'] ?></p>
                                                <p class="myTextDate"><?= date('H:i', strtotime($psn['tgl'])) ?></p>
                                            </div>
                                        </div>
                                        <div class="senderImg" style="margin:0 1vw 0 1vw;"><img src="data:image/jpeg;base64,<?= base64_encode($psn['foto']) ?>" /></div>
                                    </div>
                                <?php } ?>
                        <?php }
                        } ?>
                    </div>
                </div>
                <div class="inputField">
                    <textarea name="inputText" id="inputText" cols="132" rows="1"></textarea>
                </div>
                <button id="sendButton">
                </button>
            </div>
        <?php } ?>
    </div>
    <div style="display: none;">
        <div id="topUpHeader">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 23.245 15">
                <path id="Icon_material-group-add" data-name="Icon material-group-add" d="M7.748,13.269H4.843V9.808H2.906v3.462H0v2.308H2.906v3.462H4.843V15.577H7.748Zm9.685,1.154a3.209,3.209,0,0,0,2.9-3.462,3.209,3.209,0,0,0-2.9-3.462,2.472,2.472,0,0,0-.881.162,6.47,6.47,0,0,1,.872,3.3,6.6,6.6,0,0,1-.872,3.3A2.472,2.472,0,0,0,17.434,14.423Zm-4.843,0a3.209,3.209,0,0,0,2.9-3.462,3.209,3.209,0,0,0-2.9-3.462,3.216,3.216,0,0,0-2.906,3.462A3.216,3.216,0,0,0,12.591,14.423ZM19,16.915a4.61,4.61,0,0,1,1.337,3.277V22.5h2.906V20.192C23.245,18.415,20.95,17.319,19,16.915Zm-6.412-.185c-1.937,0-5.811,1.154-5.811,3.462V22.5H18.4V20.192C18.4,17.885,14.528,16.731,12.591,16.731Z" transform="translate(0 -7.5)" fill="#d7c13f" />
            </svg>
            <h5 class="yellow" style="margin-left: 1vw;">Add Friend</h5>
        </div>
        <div id="topUpBody">
            <h6 style="color: #ecf0f1">Input Username </h6>
            <input type="text" class="topUpAmount" name="topUpAmount" id="username">
        </div>
    </div>
</body>
<script src="Js/alertify.js"></script>
<script>
    var keys = {};
    var ctr = 0;
    var select = -1;

    <?php if (isset($user)) { ?>
        userA = '<?= $user['id_user'] ?>';
    <?php } ?>

    <?php if (isset($friendA)) { ?>
        friendA = '<?= $friendA['id_user'] ?>';
    <?php } ?>

    $(document).ready(function() {
        <?php if (!isset($_SESSION['idFriend'])) { ?>
            $(".memberlist").css("display", "none");
            $(".chatHeader").css("display", "none");
            $(".chatSection").css("display", "none");
        <?php } else { ?>
            $(".memberlist").addClass("slideInRight animated");
            $(".chatHeader").addClass("slideInDown animated");
            $(".chatSection").addClass("slideInUp animated");
            $("#banner").addClass("fadeOut animated");
        <?php } ?>
    });

    $("#inputText").keydown(function(e) {
        keys[e.which] = true;
        if (keys[13] && !keys[16]) {
            e.preventDefault();
            $("#sendButton").trigger("click");
        } else if (keys[13] && keys[16]) {
            if ($(".chatField").css("height") != "624px") {
                var height = parseInt($(this).css("height"));
                height += 26;
                $(this).css("height", height);
                ctr++;
                var height = parseInt($(".inputField").css("height"));
                height += 26;
                $(".inputField").css("height", height);

                var height = parseInt($(".chatField").css("height"));
                height -= 26;
                $(".chatField").css("height", height);
            }
        }
    });

    $("#inputText").focus(function() {
        $("#inputText").on("input", function() {
            if (keys[17] && keys[86]) {
                if ($(this).prop('scrollHeight') > $(this).prop('clientHeight')) {
                    var tambah = true;
                    while (tambah) {
                        if ($(".chatField").css("height") != "624px" && $(this).prop('scrollHeight') > $(this).prop('clientHeight')) {
                            var height = parseInt($(this).css("height"));
                            height += 26;
                            $(this).css("height", height);
                            var height = parseInt($(".inputField").css("height"));
                            height += 26;
                            ctr++;
                            $(".inputField").css("height", height);
                            var height = parseInt($(".chatField").css("height"));
                            height -= 26;
                            $(".chatField").css("height", height);
                        } else tambah = false;
                        var chatHeight = parseInt($(".chatField").css("height"));
                        if (chatHeight <= 624) tambah = false;
                    }
                }
                console.log($(".chatField").css("height"));
            } else {
                if ($(".chatField").css("height") != "624px") {
                    if ($(this).prop('scrollHeight') > $(this).prop('clientHeight')) {
                        var height = parseInt($(this).css("height"));
                        height += 26;
                        $(this).css("height", height);
                        var height = parseInt($(".inputField").css("height"));
                        height += 26;
                        ctr++;
                        $(".inputField").css("height", height);
                        var height = parseInt($(".chatField").css("height"));
                        height -= 26;
                        $(".chatField").css("height", height);
                    }
                }
            }
        });

    });

    $("#inputText").keyup(function(e) {
        delete keys[e.which];
    });

    $("#sendButton").click(function() {
        var height = parseInt($("#inputText").css("height"));
        height -= 26 * ctr;
        $("#inputText").css("height", height);
        var height = parseInt($(".inputField").css("height"));
        height -= 26 * ctr;
        $(".inputField").css("height", height);

        var height = parseInt($(".chatField").css("height"));
        height += 26 * ctr;
        $(".chatField").css("height", height);
        ctr = 0;

        <?php if (isset($user) && isset($friendA)) { ?>
            idUser = '<?= $user['id_user'] ?>';
            idFriend = '<?= $friendA['id_user'] ?>';
        <?php } ?>

        pesan = $("#inputText").val();
        //alert(pesan);
        $.ajax({
            url: "<?= base_url(); ?>Community/insertPesan",
            method: "post",
            data: {
                id_pengirim: idUser,
                id_penerima: idFriend,
                tipe_penerima: "User",
                pesan: pesan
            },
            success: function(result) {
                $(".chatField").html(result);
                $("#inputText").val("");
            }
        });
        alertify.success("Message sent");
    });


    $(".accItemContainer").on("click", ".listChannel", function() {
        idFriend = $(this).attr("idFriend");
        $.ajax({
            url: "<?= base_url(); ?>Community/chooseFriend",
            method: "post",
            data: {
                idFriend: idFriend
            },
            success: function(result) {
                window.location.href = '<?= base_url(); ?>Community/viewFriend';
            }
        });
    });

    $(".accItemContainer").on("click", ".listBlock", function() {
        idFriend = $(this).attr("idFriend");
        alertify.confirm('Confirmation', 'Are you sure unblock this User?',
            function() {
                $.ajax({
                    url: "<?= base_url(); ?>Community/unblockUser",
                    method: "post",
                    data: {
                        id_user1: userA,
                        id_user2: idFriend
                    },
                    success: function(result) {
                        $(".blockList").html(result);
                        alertify.success('Unblocked!');
                    }
                });

            },
            function() {
                alertify.error('Cancel');
            }
        ).set('labels', {
            ok: 'Unblock',
            cancel: 'Cancel'
        });
    });

    $(".btnTeams").click(function() {
        window.location.href = '<?= base_url(); ?>Community/viewTeam';
    });

    $(".btnChannel").click(function() {
        window.location.href = '<?= base_url(); ?>Community/viewChannel';
    });

    $(".btnFriend").click(function() {
        window.location.href = '<?= base_url(); ?>Community/viewFriend';
    });


    $(".Home").click(function() {
        window.location.href = '<?= base_url(); ?>MainMenu/';
    });

    var headerTopUp = $("#topUpHeader").html();
    var bodyTopUp = $("#topUpBody").html();
    $("#topUpHeader").html("");
    $("#topUpBody").html("");

    $("#add").click(function() {
        alertify.confirm(bodyTopUp).set('onok', function(closeevent, value) {
            username = $("#username").val();
            $.ajax({
                url: "<?= base_url(); ?>Community/cekUsername",
                method: "post",
                data: {
                    username: username
                },
                success: function(result) {
                    if (result == false) {
                        alertify.error("Can't find username Friend");
                    } else {
                        $(".friendList").html(result);
                        alertify.success("Friend request has been sent");
                    }
                }
            });
        }).set({
            onfocus: function() {
                $(".ajs-input").attr("id", "idChannel");
            },
            'title': headerTopUp
        });
    });

    $("#action1").click(function() {
        alertify.confirm('Confirmation', 'Accept ?',
            function() {
                $.ajax({
                    url: "<?= base_url(); ?>Community/updateAddfriend",
                    method: "post",
                    data: {
                        id_user1: userA,
                        id_user2: friendA
                    },
                    success: function(result) {
                        $("#action1").hide();
                        $("#action2").show();

                        alertify.success('Accepted!');
                    }
                });

            },
            function() {
                alertify.error('Cancel');
            }
        ).set('labels', {
            ok: 'Accept',
            cancel: 'Cancel'
        });
    });


    $("#action2").click(function() {
        <?php if (isset($friendA)) { ?>
            trade = '<?= $friendA['trade_link'] ?>';
        <?php   }   ?>
        alertify.alert("Trade Link", trade);
    });


    $("#action3").click(function() {
        alertify.confirm('Confirmation', 'Are you sure block this User?',
            function() {
                $.ajax({
                    url: "<?= base_url(); ?>Community/blockUser",
                    method: "post",
                    data: {
                        id_user1: userA,
                        id_user2: friendA
                    },
                    success: function(result) {
                        $(".blockList").html(result);
                        alertify.success('Blocked!');
                    }
                });

            },
            function() {
                alertify.error('Cancel');
            }
        ).set('labels', {
            ok: 'Block',
            cancel: 'Cancel'
        });
    });

    $(".search").click(function() {
        keyword = $(".searchBarInput").val();
        $.ajax({
            url: "<?= base_url(); ?>Community/searchFriend",
            method: "post",
            data: {
                keyword: keyword
            },
            success: function(result) {
                $(".friendList").html(result);
                $(".searchBarInput").val("");
            }
        });

    });
</script>

</html>